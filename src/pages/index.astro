---
import DeferredSection from '../components/server/app/DeferredSection.astro';
import SyndicateStream from '../components/server/FrontPage/SyndicateStream/SyndicateStream.astro';
import TopSitesStream from '../components/server/FrontPage/TopSitesStream.astro';
import TopThreadsStream from '../components/server/FrontPage/TopThreadsStream.astro';
import BackgroundPoster from '../components/server/ui/BackgroundPoster.astro';
import FrontpageFabs from '../components/svelte/frontpage/FrontpageFabs.svelte';
import Page from '../layouts/Page.astro';

// Set a short cache time for the front page
Astro.response.headers.set(
  'Cache-Control',
  's-maxage=1, stale-while-revalidate',
);
---
<Page title={import.meta.env.PUBLIC_APP_NAME}>
    <div class="content-columns">
      
      <TopThreadsStream/>
      
      <SyndicateStream server:defer>
        <DeferredSection class="column-s" slot="fallback" />
      </SyndicateStream>

      <TopSitesStream />

    </div>
    <FrontpageFabs client:only="svelte" slot="fab-tray"/>
    <BackgroundPoster
      slot="app-background-poster"
      src="/myrrys-proprietary/juno-viinikka/juno-viinikka-dragon-1.webp"
      md="/myrrys-proprietary/juno-viinikka/juno-viinikka-dragon-1-960.webp"
    />
    <p class="text-caption text-center" style="opacity:0.44" slot="app-footer-credits">
      Taustakuva Â© Juno Viinikka (<a href="https://linktr.ee/junowski">https://linktr.ee/junowski</a>)
    </p>
</Page>